---
title: Euler Earn
description: An open source protocol for permissionless risk curation on top of ERC4626 vaults
---

# Euler Earn Whitepaper

Mick de Graaf & Haythem Sellami.

<!-- TOC FOLLOWS -->
<!-- START OF TOC -->
<!-- DO NOT EDIT! Auto-generated by md-toc: https://github.com/hoytech/md-toc -->

* [Introduction](#introduction)
* [Motivation](#motivation)
* [Permissionless Yield Aggregation & Risk Management](#permissionless-yield-aggregation--risk-management)
* [Core concepts](#core-concepts)
    * [Strategy](#strategy)
    * [Cash reserve](#cash-reserve)
    * [Allocation Points](#allocation-points)
    * [Rebalance](#rebalance)
    * [Harvest](#harvest)
    * [Performance Fee](#performance-fee)
    * [Loss Deduction](#loss-deduction)
    * [Yield Gulping & Smearing ](#yield-gulping--smearing-)
    * [Withdrawal Queue](#withdrawal-queue)
    * [Roles](#roles)
    * [Strategy Emergency Status](#strategy-emergency-status)
    * [Native ERC20 Votes](#native-erc20-votes)
* [Immutability, Management and Fees](#immutability-management-and-fees)

<!-- END OF TOC -->

## Introduction

Euler Earn is an open source protocol for permissionless risk curation on top of [ERC4626 vaults](https://eips.ethereum.org/EIPS/eip-4626) (strategies). Although it is initially designed to be integrated with [Euler V2 vaults](https://github.com/euler-xyz/euler-vault-kit), technically it supports any other vault as long as it is ERC4626 compliant.
Euler Earn in itself is an ERC4626 vault, and any risk curator can deploy one through the factory. Each vault has one underlying asset and can allocate deposits to multiple strategies. Euler Earn vaults are noncustodial and immutable instances, and offer users an easy way to provide liquidity and passively earn yield. 

## Motivation

Euler V2 is a lending and borrowing protocol built on top of the EVC primitive, prioritising modularity, efficiency and flexibility. On Euler V2, lenders must consider multiple factors, including the loan-to-value ratio, the used oracles, caps, the type of vault(borrowable, escrow)...etc. For that reason, interacting with lending vaults directly is more suited to sophisticated and knowledgeable lenders than passive ones. That’s why we introduce Euler Earn, to provide a passive yield for users, and to manage the risk on their behalf.

## Permissionless Yield Aggregation & Risk Management

Anyone can use the factory to create a EulerEarn vault, including DAOs, protocols, risk experts, funds…etc can all leverage the permissionless infrastructure to provide passive users with a simple yield earning experience.

## Core concepts

### Strategy

An ERC4626 compatible contract in which the euler earn vault will deposit assets. A single Euler Earn vault can have many strategies.

A strategy can be any ERC4626 compliant vault:
- Euler V2 lending protocol vaults.
- Yearn V3 vaults.
- MetaMorpho vaults.
- etc...

The strategy with address zero is used as a cash reserve. 

### Cash reserve

An amount of the total deposited assets not allocated to any strategy, and used as the first source of liquidity during withdrawal. The amount to set as cash reserve is decided based on the allocation points set for the cash reserve strategy.

### Allocation Points

Each strategy gets assigned allocation points, including the cash reserve strategy.
During strategy rebalance, the amount of asset to allocate is calculated based on its allocation points.

### Rebalance

The user's deposited assets are allocated across the Euler Earn vault’s strategies through rebalance. When executing a rebalance, Earn vault will deposit more assets to the strategy or withdraw from it based on its current and target allocation amounts. 

### Harvest

Harvesting strategies are required to count for accrued yield, and this can be executed in a permissionless way by any user.
During harvesting, Earn vault goes through all the strategies to calculate the net yield amount, and that happens according to the order of the strategies in the withdrawal queue.
In case of positive net yield, a performance fee is accrued, if applicable. In case of negative net yield, a loss deduction mechanism is applied.

### Performance Fee

A performance fee can be accrued for the aggregated net yield amount, by converting the fee assets to Euler Earn vault shares and minting it to the fee recipient.

### Loss Deduction

A loss deduction mechanism is implemented in case of harvesting a negative net yield amount. The net negative yield amount will be first deducted from the interest left to accrue, if not enough to cover that, the rest will be socialised across depositors.

### Yield Gulping & Smearing 

Harvested positive yield is not instantly added to the Euler Earn vault total deposits, instead, it gets gulped as an interest to be distributed (smeared) along the smearing period (2 weeks), and that prevents sudden jumps in the euler earn vault’s exchange rate.

### Withdrawal Queue

A queue of strategies addresses, mainly used during yield harvesting and executing withdrawal requests from the euler earn.
Strategies are pushed into the withdrawal queue and removed from it when the add or removing strategy operation is called. Only the address that holds the withdrawal queue manager role can re-order it.

### Roles

Governance over the euler earn vault can be granularly managed. Both fully ungoverned or completely governed are both easily achieved through access control management.
An Euler Earn vault can have different managers each serving a specific role. Setting up the vaults can be set in a manner which makes sure no entity is able to take user funds from the vault.
Each role has their own specific `Admin role`, the holder of the Admin role can assign the role. The `Default Admin` role has ownership of all other admin roles.

- Default Admin:
    - Manages admin roles, including itself.
- Strategy Operator:
    - Add strategy.
    - Remove strategy.
- Euler Earn Vault Manager:
    - Set performance fee and recipient.
    - Opt in & out from the underlying strategy rewards stream, including enable/disable and claiming rewards.
    - Set hooks config.
- Withdrawal Queue Manager:
    - Re-order withdrawal queue array.
- Guardian:
    - Set strategy cap.
    - Adjust strategy allocation points.
    - Set strategy as `Emergency` or revert it back.

### Strategy Emergency Status

In case of a faulty strategy that has already an allocated amount, the Guardian can set that strategy status as `Emergency`, therefore the Earn vault will be functioning as expected, without taking into account that specific strategy.

The Guardian can toggle back the strategy status back to active anytime.

### Native ERC20 Votes

Euler Earn vault natively integrates with ERC20Votes contract to support Compound-like voting and delegation, therefore the users and shareholders of a certain Earn vault, can use their shares as voting power in the vault governance.

## Immutability, Management and Fees

The EulerEarn is a robust and yet flexible protocol, by providing an immutable set of contracts and a set of parameters to configure. 

The core contracts are fully immutable, where the set of parameters to configure are governed by the different roles owner, as explained above. Additionally, risk curators can easily provide a fully immutable experience by revoking access to the roles mentioned above.

Euler DAO can’t take fees on Euler Earn Vaults but Vaults owners can set a performance fee, as explained above. The maximum performance fee is 50%.